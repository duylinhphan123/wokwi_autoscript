# Wokwi CLI - Universal Toolkit

� **Command Line Interface cho Wokwi Simulator với đầy đủ tính năng**

## 🌟 Tính năng chính

### 🔧 Firmware Scanner
✅ **Tự động scan firmware files** (.bin và .elf)  
✅ **Hỗ trợ đa platform:**
- 📱 **STM32** (STM32CubeIDE projects) - tìm trong thư mục `Debug/`
- 🔥 **ESP32** (PlatformIO projects) - tìm trong thư mục `.pio/build/`

✅ **Smart detection:**
- Tự động phát hiện loại project
- Nhóm files theo cặp .bin/.elf
- Chọn firmware mới nhất nếu có nhiều options

### 📦 Diagram Manager
✅ **Wokwi Diagram Downloader**
- Download diagram.json từ Wokwi projects
- Tự động extract từ ZIP files
- Quản lý project configurations

### 🎯 Command Line Interface
✅ **Unified CLI với nhiều commands:**
- `wokwi -setup` - Firmware scanning và setup
- `wokwi -diagram` - Diagram downloading
- `w -setup` - Shorthand commands
- Cross-platform support (Windows/Linux/macOS)

## 🚀 Cách sử dụng

### 🎯 CLI Commands (Khuyên dùng)
```cmd
# Windows
wokwi.cmd -setup          # Scan và setup firmware
wokwi.cmd -diagram        # Download diagram từ Wokwi  
wokwi.cmd -help          # Hiển thị help
wokwi.cmd -version       # Thông tin phiên bản

# Shorthand
w.cmd -setup             # Lệnh ngắn gọn
w.cmd -diagram

# Linux/macOS
./wokwi.sh -setup        # Bash script cho Unix
./wokwi.sh -diagram
```

### �️ GUI Methods (Legacy)
```cmd
# Double-click batch files
scan_firmware.cmd        # Chỉ firmware scanning

# Direct Python execution
python setup.py          # Firmware scanner
python diagram.py        # Diagram downloader
```

### 📋 Available Commands
```cmd
Setup Commands:
  -setup, -scan, -config  # Firmware scanning và configuration
  
Diagram Commands:  
  -diagram                 # Download diagram.json từ Wokwi

Info Commands:
  -help, -h               # Hiển thị hướng dẫn
  -version, -v            # Thông tin phiên bản
```

## Cấu trúc project được hỗ trợ

### STM32CubeIDE Project
```
MySTM32Project/
├── MyProject.ioc          # ← Tự động phát hiện STM32
├── Core/
├── Debug/
│   ├── MyProject.bin     # ← Tự động tìm
│   └── MyProject.elf     # ← Tự động tìm
└── Wokwi_ESP32/
    ├── setup.py
    └── wokwi.toml        # ← Được tạo tự động
```

### PlatformIO Project  
```
MyESP32Project/
├── platformio.ini         # ← Tự động phát hiện ESP32/PlatformIO
├── src/
├── .pio/build/esp32dev/
│   ├── firmware.bin      # ← Tự động tìm
│   └── firmware.elf      # ← Tự động tìm
└── wokwi.toml           # ← Được tạo tự động
```

## Output - wokwi.toml

Script tạo file `wokwi.toml` với format:

```toml
# Wokwi Configuration
# Generated by Universal Firmware Scanner  
# Firmware: MyProject.bin (4,672 bytes)
# ELF: MyProject.elf (653,520 bytes)
# Build time: Wed Sep 17 15:22:15 2025

[wokwi]
version = 1
firmware = '../Debug/MyProject.bin'
elf = '../Debug/MyProject.elf'
```

## Tính năng nâng cao

### Multiple Firmware Detection
Nếu tìm thấy nhiều firmware groups, script sẽ hiển thị menu:

```
🔍 Tìm thấy 2 firmware groups:
1. project1 (E:\Project\Debug\)
   📁 BIN: project1.bin  
   📁 ELF: project1.elf

2. project2 (E:\Project\Release\)
   📁 BIN: project2.bin
   📁 ELF: project2.elf

Chọn firmware group (1-2) hoặc Enter để chọn mới nhất: 
```

### Smart Path Resolution
- Tự động tạo đường dẫn tương đối chính xác
- Normalize paths cho Windows (`\` thay vì `/`)
- Tìm project root để tạo paths tối ưu

## Requirements

- ✅ Python 3.6+
- ✅ Không cần thư viện external (chỉ dùng built-in modules)

## Troubleshooting

### ❌ "Không tìm thấy file .bin hoặc .elf"
**Giải pháp:**
- **STM32:** Build project trong STM32CubeIDE trước
- **ESP32:** Chạy `pio run` trong PlatformIO

### ❌ "Không tìm thấy cặp .bin/.elf đầy đủ"  
**Giải pháp:**
- Đảm bảo cả 2 files .bin và .elf có cùng tên
- Kiểm tra quyền truy cập thư mục

### ❌ Python không được tìm thấy
**Giải pháp:**
- Cài đặt Python từ [python.org](https://python.org)
- Thêm Python vào PATH trong quá trình cài đặt

## Changelog

### v2.0 - Universal Scanner
- ➕ Hỗ trợ tự động scan thay vì hardcode paths
- ➕ Hỗ trợ cả STM32 và ESP32
- ➕ Smart project detection
- ➕ Multiple firmware groups support  
- ➕ Enhanced UI với colors và icons
- ➕ Detailed file information (size, build time)

### v1.0 - PlatformIO Only
- ✅ Chỉ hỗ trợ PlatformIO projects
- ✅ Basic wokwi.toml generation

---

**Made with ❤️ for Wokwi Simulator**